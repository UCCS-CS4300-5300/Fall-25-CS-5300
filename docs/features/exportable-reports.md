# Exportable Reports Feature

Generate professional PDF interview reports with AI-powered feedback and performance scoring.

## Overview

The Exportable Reports feature allows users to transform their interview chat sessions into structured, professional reports that can be viewed in the browser or downloaded as PDFs.

## User Workflow

### 1. Complete Interview

Users must first complete an interview chat session:

1. Create a chat from `/chat/create/`
2. Conduct the interview by exchanging messages
3. View results at `/chat/<id>/results/`

### 2. Generate Report

From the results page:

1. Click **"Generate Report"** button
2. System analyzes chat messages
3. Extracts performance scores and feedback
4. Creates structured report data

### 3. View Report

After generation:

1. Redirected to `/chat/<id>/export-report/`
2. View formatted report in browser
3. See performance scores, feedback, and Q&A

### 4. Download PDF

From the export page:

1. Click **"Download as PDF"** button
2. PDF is generated on-the-fly
3. Download begins automatically
4. Filename: `interview_report_{chat_title}_{timestamp}.pdf`

---

## Report Sections

### Interview Details

- **Interview Type:** General, Skills, Personality, or Final Screening
- **Difficulty Level:** 1-10 scale
- **Completion Date:** When the interview was completed
- **Job Position:** Linked job listing (if any)
- **Resume:** Linked resume (if any)

### Performance Assessment

**Four scoring categories (0-100 scale):**

1. **Professionalism Score**
   - Evaluates professional conduct during the interview
   - Includes courtesy, responsiveness, and professionalism

2. **Subject Knowledge Score**
   - Evaluates technical or domain expertise
   - Measures depth and accuracy of answers

3. **Clarity Score**
   - Evaluates communication clarity
   - Assesses how well ideas are expressed

4. **Overall Score**
   - Aggregate performance score
   - Weighted combination of all categories

**Score Ratings:**
- 90-100: Excellent
- 70-89: Good
- 50-69: Fair
- 0-49: Needs Improvement

### AI Feedback

Textual feedback generated by the AI interviewer:
- Strengths identified
- Areas for improvement
- Specific recommendations
- Overall impression

### Question & Response Analysis

Detailed breakdown of each interview question:
- **Question:** The question asked
- **Answer:** User's response
- **Score:** Individual question score (0-10)
- **Feedback:** Specific feedback for that answer

### Statistics

- **Total Questions Asked:** Count of interviewer questions
- **Total Responses Given:** Count of candidate responses
- **Interview Duration:** Time spent (if tracked)

---

## PDF Features

### Professional Design

- Clean, modern layout
- Consistent color scheme (primary blue: #1a73e8)
- Professional typography (Helvetica fonts)
- Branded header with title

### Multi-Page Support

- Automatic page breaks
- Page numbers (future enhancement)
- Consistent headers/footers

### Visual Elements

- Score grid with color coding
- Tables with alternating row colors
- Section dividers
- Timestamp footer

### File Details

- **Format:** PDF (portable document format)
- **Library:** ReportLab
- **Size:** Varies by content (typically 100-500 KB)
- **Compatibility:** Universal PDF reader support

---

## Use Cases

### For Job Seekers

- **Practice tracking:** Monitor improvement over time
- **Portfolio piece:** Share with mentors or coaches
- **Self-assessment:** Review performance objectively
- **Interview prep:** Identify areas to improve before real interviews

### For Career Coaches

- **Client progress:** Track client improvement
- **Feedback documentation:** Provide structured feedback
- **Goal setting:** Identify specific skills to develop

### For Recruiters (Future)

- **Candidate assessment:** Evaluate interview readiness
- **Skill verification:** Verify claimed competencies
- **Hiring decisions:** Data-driven candidate evaluation

---

## Technical Implementation

### Data Model

**ExportableReport Model:**
- OneToOne relationship with Chat
- Stores scores (0-100)
- Stores AI feedback text
- Stores question-response array (JSON)
- Tracks statistics and metadata

**See:** [Models Documentation](../architecture/models.md#exportablereport)

### Score Extraction

Scores are extracted from AI messages using regex patterns:

```
Professionalism: 85/100
Subject Knowledge: 90/100
Clarity: 78/100
Overall: 84/100
```

AI responses must include these patterns for score extraction to work.

### PDF Generation

**Engine:** ReportLab library

**Process:**
1. Create PDF canvas
2. Add title section
3. Generate metadata table
4. Create performance score grid
5. Add AI feedback section
6. Generate Q&A breakdown
7. Add statistics summary
8. Add footer with timestamp
9. Return PDF as BytesIO

**File:** `active_interview_app/pdf_export.py`

### Web Interface

**Template:** `active_interview_app/templates/reports/export-report.html`

**Features:**
- Responsive card-based layout
- Bootstrap 5 styling
- Download and navigation buttons
- Score visualization grid
- Mobile-friendly design

---

## API Endpoints

### Generate Report (POST)

```
POST /chat/<chat_id>/generate-report/
```

**Authentication:** Required (user must own chat)

**Process:**
1. Validates ownership
2. Creates/updates ExportableReport
3. Parses chat messages for scores/feedback
4. Saves report to database
5. Redirects to export view

### View Report (GET)

```
GET /chat/<chat_id>/export-report/
```

**Authentication:** Required (user must own chat)

**Returns:** HTML page with formatted report

### Download PDF (GET)

```
GET /chat/<chat_id>/download-pdf/
```

**Authentication:** Required (user must own chat)

**Returns:** PDF file download

**Headers:**
- `Content-Type: application/pdf`
- `Content-Disposition: attachment; filename="interview_report_...pdf"`

---

## Permissions

**Access Control:**
- User must be logged in (`LoginRequiredMixin`)
- User must own the chat (`UserPassesTestMixin`)
- Unauthorized access returns 403 Forbidden

**Data Privacy:**
- Reports are private to the owning user
- No public or shared report URLs
- Deleted chats cascade-delete reports

---

## Limitations

### Current Limitations

1. **AI-Dependent:** Requires AI to format feedback with specific score patterns
2. **No Templates:** Single report template (no customization)
3. **No Sharing:** Can't share reports with others
4. **No History:** Each chat has max one report (latest overwrites)
5. **Manual Trigger:** Must manually click "Generate Report"

### Future Enhancements

**Planned:**
- Multiple export formats (CSV, Excel, JSON)
- Email delivery option
- Report templates (formal, casual, detailed)
- Batch report generation
- Report sharing with stakeholders
- Historical report versions
- Graphical charts and visualizations
- Comparative analysis across interviews

---

## Example Report Structure

```
=================================================
     INTERVIEW REPORT: Python Developer
=================================================

INTERVIEW DETAILS
─────────────────────────────────────────────────
Interview Type:      Industry Skills
Difficulty Level:    7/10
Completion Date:     January 15, 2025
Job Position:        Senior Python Developer
Resume:              John Doe Resume

PERFORMANCE ASSESSMENT
─────────────────────────────────────────────────
┌──────────────────────┬────────┬──────────────┐
│ Category             │ Score  │ Rating       │
├──────────────────────┼────────┼──────────────┤
│ Professionalism      │  85    │ Good         │
│ Subject Knowledge    │  92    │ Excellent    │
│ Clarity              │  78    │ Good         │
│ Overall              │  85    │ Good         │
└──────────────────────┴────────┴──────────────┘

AI FEEDBACK
─────────────────────────────────────────────────
Strong technical knowledge demonstrated throughout
the interview. Excellent grasp of Python concepts
including decorators, generators, and async/await.

Communication was generally clear, though some
responses could be more concise...

QUESTION & RESPONSE ANALYSIS
─────────────────────────────────────────────────
Q1: Explain the difference between lists and tuples
A: Lists are mutable while tuples are immutable...
Score: 9/10
Feedback: Excellent answer with clear examples.

Q2: What is a Python decorator?
A: A decorator is a function that wraps another...
Score: 8/10
Feedback: Good explanation, could add more detail...

[Additional Q&A pairs...]

STATISTICS
─────────────────────────────────────────────────
Total Questions:     10
Total Responses:     10
Duration:            45 minutes

─────────────────────────────────────────────────
Generated: January 15, 2025 at 3:45 PM
```

---

## Testing

**Test File:** `active_interview_app/tests/test_exportable_report.py`

**Coverage:**
- Model creation and validation
- Score range validation (0-100)
- Report generation from chats
- PDF generation functionality
- View access permissions
- API endpoints
- Edge cases and error handling

**Test Count:** 369 lines, comprehensive coverage

---

## Related Documentation

- **[Models: ExportableReport](../architecture/models.md#exportablereport)** - Data model details
- **[Architecture Overview](../architecture/overview.md)** - System integration
- **[Testing Guide](../setup/testing.md)** - How to test this feature

---

## Support

For issues or questions about the Exportable Reports feature:

1. Check the [Troubleshooting Guide](../setup/troubleshooting.md)
2. Review the [Models Documentation](../architecture/models.md)
3. Create a GitHub issue with details
