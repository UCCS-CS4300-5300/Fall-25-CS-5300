{% extends "base-sidebar.html" %}
{% block title %}
  AIS - Export Report - {{ chat.title }}
{% endblock title %}
{% block content %}
  <!-- Following hierarchical class system from style guide -->

  <div class="container-page container-standard">
    <div style="text-align: center; margin: 2rem 0;">
      <h1 class="text-brand">Exportable Report: {{ chat.title }}</h1>
    </div>

    <!-- Export Actions -->
    <div style="display: flex; gap: 1rem; justify-content: center; margin: 2rem 0; flex-wrap: wrap;">
      <a href="{% url 'download_pdf_report' chat.id %}" class="btn btn-danger" style="padding: 1rem 2rem; font-size: 1rem;">
        Download as PDF
      </a>
      <a href="{% url 'chat-results' chat.id %}" class="btn btn-secondary" style="padding: 1rem 2rem; font-size: 1rem;">
        Back to Results
      </a>
    </div>

    <!-- Interview Metadata -->
    <div class="box box-section">
      <h2>Interview Details</h2>
      <table class="metadata-table">
        <tr>
          <td>Interview Type:</td>
          <td>{{ chat.get_type_display }}</td>
        </tr>
        <tr>
          <td>Difficulty Level:</td>
          <td>{{ chat.difficulty }}/10</td>
        </tr>
        <tr>
          <td>Date Completed:</td>
          <td>{{ chat.modified_date|date:"F d, Y" }}</td>
        </tr>
        <tr>
          <td>Report Generated:</td>
          <td>{{ report.generated_at|date:"F d, Y \a\t h:i A" }}</td>
        </tr>
        {% if chat.job_listing %}
        <tr>
          <td>Job Position:</td>
          <td>{{ chat.job_listing.title }}</td>
        </tr>
        {% endif %}
        {% if chat.resume %}
        <tr>
          <td>Resume:</td>
          <td>{{ chat.resume.title }}</td>
        </tr>
        {% endif %}
      </table>
    </div>

    <!-- Performance Scores -->
    {% if report.overall_score %}
    <div class="box box-section">
      <h2>Performance Assessment</h2>
      <div class="list-grid list-grid-2" style="gap: 1rem; margin: 1rem 0;">
        <div class="box box-score">
          <h3 class="text-secondary-color text-sm" style="text-transform: uppercase; margin-bottom: 0.5rem;">Professionalism</h3>
          <div class="text-brand" style="font-size: 2rem; font-weight: bold;">{{ report.professionalism_score|default:"N/A" }}</div>
          <div class="text-secondary-color text-sm" style="margin-top: 0.5rem;">/100</div>
        </div>
        <div class="box box-score">
          <h3 class="text-secondary-color text-sm" style="text-transform: uppercase; margin-bottom: 0.5rem;">Subject Knowledge</h3>
          <div class="text-brand" style="font-size: 2rem; font-weight: bold;">{{ report.subject_knowledge_score|default:"N/A" }}</div>
          <div class="text-secondary-color text-sm" style="margin-top: 0.5rem;">/100</div>
        </div>
        <div class="box box-score">
          <h3 class="text-secondary-color text-sm" style="text-transform: uppercase; margin-bottom: 0.5rem;">Clarity</h3>
          <div class="text-brand" style="font-size: 2rem; font-weight: bold;">{{ report.clarity_score|default:"N/A" }}</div>
          <div class="text-secondary-color text-sm" style="margin-top: 0.5rem;">/100</div>
        </div>
        <div class="box box-score">
          <h3 class="text-secondary-color text-sm" style="text-transform: uppercase; margin-bottom: 0.5rem;">Overall Score</h3>
          <div class="text-brand" style="font-size: 2rem; font-weight: bold;">{{ report.overall_score|default:"N/A" }}</div>
          <div class="text-secondary-color text-sm" style="margin-top: 0.5rem;">/100</div>
        </div>
      </div>
    </div>
    {% endif %}

    <!-- AI Feedback -->
    {% if report.feedback_text %}
    <div class="box box-section">
      <h2>AI Feedback</h2>
      <div class="box box-info" style="white-space: pre-wrap; line-height: 1.6;">{{ report.feedback_text }}</div>
    </div>
    {% endif %}

    <!-- Recommended Exercises -->
    <div class="box box-section">
      <h2>Recommended Exercises</h2>
      <div class="box box-info">
        <h3 class="text-brand" style="margin-bottom: 1rem;">To improve your interview skills, we recommend:</h3>
        <ul style="line-height: 1.8; color: var(--text-primary);">
          <li><strong>Practice STAR Method:</strong> Structure your answers using Situation, Task, Action, and Result to provide clear, concise responses.</li>
          <li><strong>Mock Interviews:</strong> Continue practicing with our AI interviewer or with peers to build confidence and fluency.</li>
          <li><strong>Research Common Questions:</strong> Review frequently asked questions for your industry and prepare thoughtful responses.</li>
          <li><strong>Technical Skills:</strong> Keep your technical skills sharp through coding challenges, projects, or online courses.</li>
          <li><strong>Behavioral Preparation:</strong> Reflect on your past experiences and prepare examples that showcase your skills and problem-solving abilities.</li>
          <li><strong>Company Research:</strong> Learn about the companies you're interviewing with to tailor your responses and ask informed questions.</li>
        </ul>
      </div>
    </div>

    <!-- Interview Statistics -->
    <div class="box box-section">
      <h2>Interview Statistics</h2>
      <div style="display: flex; gap: 2rem; flex-wrap: wrap; margin: 1rem 0;">
        <div style="flex: 1; min-width: 200px;">
          <strong class="text-secondary-color" style="display: block; margin-bottom: 0.25rem;">Total Questions Asked:</strong>
          <span class="text-primary-color">{{ report.total_questions_asked }}</span>
        </div>
        <div style="flex: 1; min-width: 200px;">
          <strong class="text-secondary-color" style="display: block; margin-bottom: 0.25rem;">Total Responses Given:</strong>
          <span class="text-primary-color">{{ report.total_responses_given }}</span>
        </div>
        {% if report.interview_duration_minutes %}
        <div style="flex: 1; min-width: 200px;">
          <strong class="text-secondary-color" style="display: block; margin-bottom: 0.25rem;">Interview Duration:</strong>
          <span class="text-primary-color">{{ report.interview_duration_minutes }} minutes</span>
        </div>
        {% endif %}
      </div>
    </div>

    <!-- Export Actions (Bottom) -->
    <div style="display: flex; gap: 1rem; justify-content: center; margin: 2rem 0; flex-wrap: wrap;">
      <a href="{% url 'download_pdf_report' chat.id %}" class="btn btn-danger" style="padding: 1rem 2rem; font-size: 1rem;">
        Download as PDF
      </a>
      <a href="{% url 'chat-results' chat.id %}" class="btn btn-secondary" style="padding: 1rem 2rem; font-size: 1rem;">
        Back to Results
      </a>
    </div>
  </div>
{% endblock content %}
