{% extends "base-sidebar.html" %}
{% block title %}
  AIS - Create AI Interview
{% endblock title %}
{% block content %}
  <style>
 .spinner-border{
  display: none;
 }
  </style>
  <div class="centered-container flex-grow-1 d-flex flex-column justify-content-center p-2">
    <h3 class="whiteTextOverride px-3 pt-3 text-center">Create an AI Interview</h3>
    <hr class="white-break">
    <div id="content-scroll"
         class="d-flex flex-column overflow-y-auto overflow-x-hidden pe-0">
      {% if from_job_analysis %}
        <div style="margin: 0 1rem 1.5rem 1rem;
                    padding: 1rem;
                    background: var(--surface-highlight);
                    border-left: 4px solid var(--primary);
                    border-radius: var(--radius)">
          <p style="margin: 0; color: var(--text-primary); font-weight: 500;">
            <svg width="16"
                 height="16"
                 viewBox="0 0 16 16"
                 fill="currentColor"
                 style="vertical-align: middle;
                        margin-right: 0.5rem">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
              <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z" />
            </svg>
            Job listing pre-selected from analysis
          </p>
          {% if suggested_template %}
            <p style="margin: 0.5rem 0 0 0;
                      color: var(--text-secondary);
                      font-size: 0.9rem">
              Recommended template: <strong>{{ suggested_template.name }}</strong>
            </p>
          {% endif %}
        </div>
      {% endif %}
      <form method="post" action="{% url "chat-create" %}" id="chat-create-form">
        {% csrf_token %}
        <table class="table borderless">
          <tbody>
            <tr>
              <td class="text-start align-middle">
                <h5 class="whiteTextOverride">Title*:</h5>
              </td>
              <td class="text-end">{{ form.title }}</td>
            </tr>
            <tr>
              <td class="text-start align-middle">
                <h5 class="whiteTextOverride">Type*:</h5>
              </td>
              <td class="text-end">{{ form.type }}</td>
            </tr>
            <tr>
              <td class="text-start align-middle">
                <h5 class="whiteTextOverride">Difficulty*:</h5>
              </td>
              <td class="text-end">{{ form.difficulty }}</td>
            </tr>
            <tr>
              <td class="text-start align-middle">
                <h5 class="whiteTextOverride">Job Listing*:</h5>
              </td>
              <td class="text-end">{{ form.listing_choice }}</td>
            </tr>
            <tr>
              <td class="text-start align-middle">
                <h5 class="whiteTextOverride">Resume:</h5>
              </td>
              <td class="text-end">{{ form.resume_choice }}</td>
            </tr>
          </tbody>
        </table>
        <div class="create-button-or-spinner d-flex justify-content-center">
          <button class="btn btn-primary mx-2"
                  name="create"
                  type="submit"
                  id="create-form-button">Create</button>
          <div class="spinner-border text-light"
               role="status"
               id="create-form-spinner">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
      </form>
    </div>
  </div>
{% endblock content %}
{% block scripts %}
  <script>
    // When the form is submitted, hide the button and show the spinner.
    document.getElementById('chat-create-form').addEventListener('submit', function(e) {
      document.getElementById('create-form-button').style.display = 'none';
      document.getElementById('create-form-spinner').style.display = 'block';
    });
  </script>
{% endblock scripts %}
